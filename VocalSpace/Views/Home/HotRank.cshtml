@model IEnumerable<VocalSpace.Models.Dto.HotRankDto>

<link rel="stylesheet" href="~/css/song.css" asp-append-version="true" />

<title>聲維宇宙排行榜</title>
<div class="container">
    <h1>聲維宇宙排行榜</h1>
    <hr />
    <div class="content">
        <aside class="sidebar">
            <ul id="myList">
                <a asp-action="HotRank" asp-route-id="0">
                <li data-id="0">總榜</li></a>
                <a asp-action="HotRank" asp-route-id="1">
                <li data-id="1">搖滾</li></a>
                <a asp-action="HotRank" asp-route-id="2">
                <li data-id="2">民謠</li></a>
                <a asp-action="HotRank" asp-route-id="3">
                <li data-id="3">嘻哈</li></a>
                <a asp-action="HotRank" asp-route-id="4">
                <li data-id="4">都會</li></a>
                <a asp-action="HotRank" asp-route-id="5">
                <li data-id="5">電子</li></a>
                <a asp-action="HotRank" asp-route-id="6">
                <li data-id="6">探索</li></a>
            </ul>
        </aside>           

        <main class="ranking">

            <div class="playAll"><button class="btn btn-danger" onclick="playAll()"><i class="bi bi-play"></i>全部播放</button></div>
            <br />
            <div id="realtime" class="ranking-list">
                @{@foreach(var item in Model){
                        <div class="ranking-item">
                            <span class="rank">@item.CurrentRank</span>

                            @{
                                if (item.CurrentRank > item.PreRank)
                                {
                                    <span class="rank">▲</span>
                                }
                                else if (item.CurrentRank < item.PreRank)
                                {
                                    <span class="rank">▼</span>
                                }
                                else
                                {
                                    <span class="rank">━</span>
                                }
                            }

                            <a href="#">
                                <img src="@item.SongCoverPhotoPath" alt="song cover">
                            </a>
                            <div class="info">
                                <a href="#"><p class="song">@item.SongName</p></a>                        
                                <a href="/Personal/mymusic"> <p class="artist">@item.SongArtist</p></a>
                            </div>
                            @await Html.PartialAsync("_SongButtonModal")
                        </div>
                    }
                }
                <div class="ranking-item"> 
                    <span class="rank">2</span> 
                    <span class="rank">▲</span> 
                <a href="#"> 
                    <img src="/image/p1.jpg" alt="song cover">
                </a>                       
                <div class="info"> 
                    <a href="#"><p class="song">打不通的電話</p></a> 
                    <a href="/Personal/mymusic"> <p class="artist">Sean Ko 高翔</p></a> 
                    </div>
                    @await Html.PartialAsync("_SongButtonModal")
                </div> 
            </div>


        </main>
    </div>
</div>

<script src="~/js/partialViewSong.js" asp-append-version="true"></script>
    <script>
    function playSong(songId) {
        alert('播放歌曲 ID: ' + songId);
    }

    function playAll() {
        alert('播放全部歌曲');
    }


     document.addEventListener("DOMContentLoaded", function () {
            // 取得當前網址的路徑，例如 `/3` 或 `/HotRank/3`
            const pathSegments = window.location.pathname.split("/").filter(segment => segment);

            // 取得最後一個段落作為 ID，若不存在則預設為 "0"
            let currentId = pathSegments.length > 0 ? pathSegments[pathSegments.length - 1] : "0";

            // 確保 currentId 是數字，否則預設為 "0"
            if (isNaN(currentId)) {
                currentId = "0";
            }

            // 清除所有 .selected
            document.querySelectorAll("#myList li").forEach(li => li.classList.remove("selected"));

            // 找到對應的 <li>，加上 .selected
            const activeLi = document.querySelector(`#myList li[data-id="${currentId}"]`);
            if (activeLi) {
                activeLi.classList.add("selected");
            }
        });

</script>
